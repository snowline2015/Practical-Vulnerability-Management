import datetime
from pymongo import MongoClient

client = MongoClient('mongodb://localhost:27017/')
db = client['vulnmgt']


def clean_up():
    oldDate = datetime.datetime.utcnow() - datetime.timedelta(days=30)
    hostsToDelete = db.hosts.count_documents({'scan_date': {'$lt': oldDate}})
    db.hosts.delete_many({'scan_date': {'$lt': oldDate}})
    print(f'Deleted {hostsToDelete} hosts older than 30 days')


