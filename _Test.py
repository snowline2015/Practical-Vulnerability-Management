import datetime
import pymongo
import json
from xml.etree import ElementTree as ET

import requests

myclient = pymongo.MongoClient("mongodb://localhost:27017/")
db = myclient["yorha"]

# mydict = { "project": "YoRHa", "name": "2B" }
# x = db.army.insert_one(mydict)
# x = db.army.insert_one(mydict)

# db.army.update_one({'project': 'YoRHa', 'name': 'WTF'},
#                     {'$set': {'project': 'YoRHa', 'type': 'Android'},
#                     }, upsert=True)

# db.army.update_one({'project': 'YoRHa', 'name': '9S'},
#                    {'$push': {'weapon': {'name': 'Machine Gun', 'type': 'Machine Gun'}},
#                     '$setOnInsert': {'project': 'YoRHa', 'name': '9S', 'weapon': [{'name': 'Machine Gun', 'type': 'Machine Gun'}]}},
#                      upsert=True)

# db.hosts.update_one({'project': 'YoRHa', 'name': '2B', 'weapon.$},

# db.army.drop()

# for x in db.army.find():
#     print(x)

# ok = db.army.distinct('project')
# haha = 0


# #
# for vuln in res:
#     for item in res[vuln]:
#         ok = 0

# cve = 'CVE-2003-0605'
# cve_searchsploit = json.load(open('Database/exploitdb_mapping_cve.json'))
# temp = '\n'.join([f'https://www.exploit-db.com/exploits/{exploit}' for exploit in cve_searchsploit[cve]] if cve in cve_searchsploit else [])
# print(temp)


# from Script import Nmap
# Nmap.Nmap.mongo_insert(None, Nmap.Nmap.get_host_data(None, 'Result/nmap.xml'))
# ok = 0

from Script import GVM
# GVM.OpenVAS.mongo_insert(None, GVM.OpenVAS.parse_xml(None, open('Result/gvm.xml').read()))

# import xml.etree.ElementTree as ET
# root = ET.fromstring(xml)
# target_id = root.findall('target')[0].attrib['id']

xml_string = open('Result/gvm.xml').read()
GVM.OpenVAS.parse_xml(None, xml_string)

ok = 0
